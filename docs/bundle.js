(()=>{"use strict";var t,e,n={},r={};function i(t){var e=r[t];if(void 0!==e)return e.exports;var l=r[t]={exports:{}};return n[t](l,l.exports,i),l.exports}e=Object.getPrototypeOf?t=>Object.getPrototypeOf(t):t=>t.__proto__,i.t=function(n,r){if(1&r&&(n=this(n)),8&r)return n;if("object"==typeof n&&n){if(4&r&&n.__esModule)return n;if(16&r&&"function"==typeof n.then)return n}var l=Object.create(null);i.r(l);var o={};t=t||[null,e({}),e([]),e(e)];for(var c=2&r&&n;"object"==typeof c&&!~t.indexOf(c);c=e(c))Object.getOwnPropertyNames(c).forEach((t=>o[t]=()=>n[t]));return o.default=()=>n,i.d(l,o),l},i.d=(t,e)=>{for(var n in e)i.o(e,n)&&!i.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},i.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),i.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.d({},{E:()=>v,Q:()=>b});const l=JSON.parse('{"major":[2,2,1,2,2,2,1],"minor":[2,1,2,2,1,2,2],"ionian":[2,2,1,2,2,2,1],"dorian":[2,1,2,2,2,1,2],"phrygian":[1,2,2,2,1,2,2],"lydian":[2,2,2,1,2,2,1],"mixolydian":[2,2,1,2,2,1,2],"aeolian":[2,1,2,2,1,2,2],"locrian":[1,2,2,1,2,2,2],"harmonic minor":[2,1,2,2,1,3,1],"melodic minor":[2,1,2,2,2,2,1]}');var o=i.t(l,2);const c={rightClick:"#ff7f50",leftClick:"#669999"};let s,a,d,f,g,u,p={},h={top:30,bottom:50,left:20,right:20};function m(t,e,n){let r=t.offsetX-h.left,i=t.offsetY-h.top+s/2;r<0&&(r=0),i<0&&(i=0),r=Math.floor(r/a)+e.startFret,i=Math.floor(i/s),i>u&&(i=u);let l=!1;for(let t in e.strings[i].selected){let o=e.strings[i].selected[t];o.fret===r&&(o.colour!==c.rightClick||n?o.colour===c.leftClick&&n?o.colour=c.rightClick:e.strings[i].selected.splice(t,1):o.colour=c.leftClick,l=!0)}l||e.strings[i].selected.push({fret:r,colour:n?"#ff7f50":"#669999"}),v()}let y=35;const b={sharps:["a","a#","b","c","c#","d","d#","e","f","f#","g","g#"],flats:["a","bb","b","c","db","d","eb","e","f","gb","g","ab"]};let F={startFret:void 0,endFret:void 0,accidentals:void 0,strings:[]};function v(){let t={frets:document.getElementById("frets-input"),tuning:document.getElementById("tuning-input"),accidentals:document.querySelector('input[name="accidentals"]:checked')};F.tuning=t.tuning.value.replace(/\s/g,"").toLowerCase().split(",").reverse();let e=t.frets.value.replace(/\s/g,"").split("-");F.startFret=parseInt(e[0]),F.endFret=parseInt(e[1]),(isNaN(F.startFret)||isNaN(F.endFret))&&(F.startFret=0,F.endFret=24),F.startFret=F.startFret>=F.endFret?0:F.startFret,F.endFret=F.endFret>y?y:F.endFret,t.frets.value=F.startFret+"-"+F.endFret,F.accidentals=t.accidentals.value,function(){for(let t of F.tuning)if(!b[F.accidentals].includes(t))return!1}(),function(){for(let t in F.tuning)F.strings[t]||(F.strings[t]={selected:[]}),F.strings[t].pitch=F.tuning[t];for(let t in F.strings)if(t>=F.tuning.length)F.strings.splice(t,1);else for(let e in F.strings[t].selected)(F.strings[t].selected[e].fret>F.endFret||F.strings[t].selected[e].fret<F.startFret)&&F.strings[t].selected.splice(e,1);!function(t){!function(t){d=document.getElementById("fretboard"),f=d.getContext("2d"),g=t.endFret-t.startFret+1,u=t.strings.length-1,d.style.width=g<=20?50*g+"px":"70%";let e=d.getBoundingClientRect();d.height=Math.floor(e.height),d.width=Math.floor(e.width),p={height:d.height-h.top-h.bottom,width:d.width-h.left-h.right},s=p.height/u,a=p.width/g}(t),f.clearRect(0,0,d.width,d.height),f.beginPath(),f.lineWidth=2,f.rect(h.left,h.top,p.width,p.height);for(let t=0;t<u;t++)f.moveTo(h.left,h.top+t*s),f.lineTo(h.left+p.width,h.top+t*s);for(let e=0;e<g;e++)f.moveTo(h.left+e*a,h.top),f.lineTo(h.left+e*a,h.top+p.height),f.fillStyle=c.leftClick,f.font="17px Poppins",f.textAlign="center",f.fillText(e+t.startFret,h.left+e*a+a/2,h.top+p.height+40);f.stroke();for(let e in t.strings)for(let n in t.strings[e].selected){let r=t.strings[e].selected[n];f.beginPath();let i=.6*a/2;i>20&&(i=20),f.arc(h.left+(r.fret-t.startFret)*a+a/2,h.top+e*s,i,0,2*Math.PI),f.fillStyle=r.colour,f.fill(),f.stroke(),f.beginPath(),f.fillStyle="white",f.font=a/5+"px Poppins",f.textAlign="center";let l=b[t.accidentals].indexOf(t.strings[e].pitch),o=b[t.accidentals][(l+r.fret)%12];o=o.charAt(0).toUpperCase()+o.slice(1),f.fillText(o,h.left+(r.fret-t.startFret)*a+a/2,h.top+e*s+a/13),f.stroke()}}(F)}()}function w(){for(let t of F.strings)t.selected=[];v()}function k(){let t=document.createElement("a");t.download="fretboard.png",t.href=document.getElementById("fretboard").toDataURL(),t.click()}window.onload=function(){[...document.getElementsByTagName("input")].forEach((t=>{"scale-input"===t.id?t.onchange=function(){!function(t){let e,n,r=document.getElementById("scale-input").value;try{e=r.split(" ")[0].toLowerCase().replace(/\s/g,""),n=r.split(" ")[1].toLowerCase().replace(/\s/g,"")}catch(t){return}b[t.accidentals].includes(e)?Object.keys(o).includes(n)?function(t,e,n){let r=b[t.accidentals].indexOf(e),i=[];for(let e of n)i.push(b[t.accidentals][r%12]),r+=e;for(let e of t.strings)e.selected=[];for(let n in t.strings){r=b[t.accidentals].indexOf(t.strings[n].pitch);for(let l=t.startFret;l<=t.endFret;l++){let o=b[t.accidentals][(l+r)%12];i.includes(o)&&t.strings[n].selected.push({fret:l,colour:o===e?c.rightClick:c.leftClick})}}v()}(t,e,o[n]):alert("Scale not found"):alert("Incorrect accidentals entered")}(F)}:t.onchange=v})),document.getElementById("fretboard").onclick=function(t){m(t,F,!1)},document.getElementById("fretboard").addEventListener("contextmenu",(function(t){t.preventDefault(),m(t,F,!0)}),!1),window.addEventListener("resize",v),document.getElementById("clear").onclick=w,document.getElementById("download").onclick=k,v()}})();